package controllers.profile;import interceptor.EedaMenuInterceptor;import interceptor.SetAttrLoginUserInterceptor;import java.util.List;import java.util.Map;import models.UserLogin;import org.apache.shiro.authz.annotation.RequiresAuthentication;import com.jfinal.aop.Before;import com.jfinal.core.Controller;import com.jfinal.log.Log;import com.jfinal.plugin.activerecord.Db;import com.jfinal.plugin.activerecord.Record;import controllers.util.ParaBuilder;import controllers.util.DbUtils;@RequiresAuthentication@Before(SetAttrLoginUserInterceptor.class)public class LoginLogController extends Controller {    private Log logger = Log.getLog(LoginLogController.class);    @Before(EedaMenuInterceptor.class)    public void index() {        render("/log/loginLog/list.html");    }        public void list(){        UserLogin user = LoginUserController.getLoginUser(this);        if(user==null){        	return;        }        long office_id=user.getLong("office_id");                ParaBuilder para = new ParaBuilder(this);                String sql = "select sl.*, ul.c_name user_name from sys_log sl "                +" left join user_login ul on sl.user_id=ul.id  where sl.office_id="+office_id;                String condition = DbUtils.buildConditions(getParaMap());                String sqlTotal = "select count(1) total from ("+sql+ condition+") B";        Record rec = Db.findFirst(sqlTotal);                List<Record> orderList = Db.find(sql+ condition + " order by  " + para.getSortColName() +" "+ para.getSortType() + para.getLimit());                Map<String, ?> orderListMap = DbUtils.buildReturnMap(para.getPageIndex(), rec.getLong("total"), orderList);        renderJson(orderListMap);     }    }