<%layout("/eeda/layout.html"){%>
	<!-- <link href="/yh/css/bootstrap-datetimepicker.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/yh/css/ui/jquery-ui.css"> -->
    <!-- <link href="/yh/js/plugins/datatables-1.10.9/css/jquery.dataTables.min.css" rel="stylesheet">
    <link href="/yh/js/plugins/sco/css/sco.message.css" rel="stylesheet">  -->
        <div id="page-wrapper">
            <div class="row">
                <div class="col-lg-12">
                    <div class="btn-header" style="font-size:32px">派车单</div>
                </div>
            </div>
            
            <div class="row">
                <form id="orderForm">
                <input id="order_id" type="hidden" name="order_id" value="${order.id!''}"/>
                    <div class="row">
                        <div class="col-lg-4">
                            <%include("/eeda/component/form/inputField.html", 
                                                {   id:'order_no', 
                                                    label:'派车单号码', 
                                                    value:order.order_no!'',
                                                    disabled: 'disabled'
                                                }){}%>
                        </div>                        
                        <div class="col-lg-4">
                            <%include("/eeda/component/form/inputCustomerField.html", 
                                {
                                    id:'customer_id', 
                                    label:'客户', 
                                    required:'required',
                                    value:order.customer_id!'',
                                    display_value: customer_name!''
                                }){} %>
                        </div>
                        <div class="col-lg-4">
                            <%include("/eeda/component/form/inputSpField.html", 
                                {
                                    id: 'sp_id', 
                                    label:' 供应商', 
                                    required: 'required',
                                    value:order.sp_id!'',
                                    display_value: sp_name!''
                                }){} %>
                        </div>
                    </div>
                    <div class="row"><!--  第4行  -->
                        <div class="col-lg-4">
                            <%include("/eeda/component/form/inputField.html", 
                                                {   id:'job_order_no', 
                                                    label:'工作单号', 
                                                    value: order.job_order_no!jobOrder.order_no!,
                                                    disabled: 'disabled'
                                                }){}%>
                        </div>
                        <div class="col-lg-4">
                            <%include("/eeda/component/form/inputField.html", 
                                                {   id:'truck_type', 
                                                    label:'车型', 
                                                    value:order.truck_type!''
                                                }){}%>
                        </div>    
                        <div class="col-lg-4">
                            <%include("/eeda/component/form/dateInputField.html", 
                                                {   id:'booking_time', 
                                                    label:'预约出车时间', 
                                                    value:order.booking_time!''
                                                }){}%>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-4">
                            <%include("/eeda/component/form/inputField.html", 
                                                {   id:'driver', 
                                                    label:'司机', 
                                                    value: order.driver!''
                                                }){}%>
                        </div>
                        <div class="col-lg-4">
                            <%include("/eeda/component/form/inputField.html", 
                                                {   id:'driver_phone', 
                                                    label:'司机电话', 
                                                    value:order.driver_phone!''
                                                }){}%>
                        </div>    
                        <div class="col-lg-4">
                            <%include("/eeda/component/form/inputField.html", 
                                                {   id:'truck_plate', 
                                                    label:'车牌', 
                                                    value:order.truck_plate!''
                                                }){}%>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-4">
                            <%include("/eeda/component/form/inputField.html", 
                                                {   id:'creator', 
                                                    label:'创建人', 
                                                    value:user.c_name!'', 
                                                    disabled: 'disabled'
                                                }){}%>
                        </div>
                        <div class="col-lg-4">
                            <%include("/eeda/component/form/inputField.html", 
                                                {   id:'create_stamp', 
                                                    label:'创建时间', 
                                                    value:order.create_stamp!'', 
                                                    disabled: 'disabled'
                                                }){}%>
                        </div>    
                        <div class="col-lg-4">
                            <%include("/eeda/component/form/inputField.html", 
                                                {   id:'status', 
                                                    label:'状态', 
                                                    value:order.status!'', 
                                                    disabled: 'disabled'
                                                }){}%>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-12">
                            <h3>提柜信息</h3>
                        </div>
                    </div>
                    <div class="row"><!--  第4行  -->
                        <div class="col-lg-4">
                            <%include("/eeda/component/form/inputField.html", 
                                                {   id:'pickup_country', 
                                                    label:'国家', 
                                                    value:order.pickup_country!''
                                                }){}%>
                        </div>
                        
                        <div class="col-lg-4">
                            <%include("/eeda/component/form/inputField.html", 
                                                {   id:'pickup_person', 
                                                    label:'联系人', 
                                                    value:order.pickup_person!''
                                                }){}%>
                        </div>
                        <div class="col-lg-4">
                           <%include("/eeda/component/form/inputField.html", 
                                                {   id:'pickup_tel', 
                                                    label:'联系电话', 
                                                    value:order.pickup_tel!''
                                                }){}%>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-8">
                            <%include("/eeda/component/form/inputField.html", 
                                                {   id:'pickup_addr', 
                                                    label:'提柜地址', 
                                                    value:order.pickup_addr!''
                                                }){}%>
                        </div>
                        <div class="col-lg-4">
                            <%include("/eeda/component/form/dateInputField.html", 
                                                {   id:'pickup_booking_time', 
                                                    label:'预约提柜时间', 
                                                    value:order.pickup_booking_time!''
                                                }){}%>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-12">
                            <h3>装货信息</h3>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-4">
                            <%include("/eeda/component/form/inputField.html", 
                                                {   id:'factory', 
                                                    label:'厂家名称', 
                                                    value:order.factory!''
                                                }){}%>
                        </div>
                        
                        <div class="col-lg-4">
                            <%include("/eeda/component/form/inputField.html", 
                                                {   id:'factory_person', 
                                                    label:'联系人', 
                                                    value:order.factory_person!''
                                                }){}%>
                        </div>
                        <div class="col-lg-4">
                           <%include("/eeda/component/form/inputField.html", 
                                                {   id:'factory_tel', 
                                                    label:'联系电话', 
                                                    value:order.factory_tel!''
                                                }){}%>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-4">
                            <%include("/eeda/component/form/inputSpField.html", 
                                {
                                    id: 'load_sp_id', 
                                    label:' 装货供应商', 
                                    required: 'required',
                                    value:order.load_sp_id!'',
                                    display_value: sp_name!''
                                }){} %>
                        </div>
                        <div class="col-lg-4">
                            <%include("/eeda/component/form/inputField.html", 
                                                {   id:'load_person', 
                                                    label:'装货联系人', 
                                                    value:order.load_person!''
                                                }){}%>
                        </div>
                        <div class="col-lg-4">
                           <%include("/eeda/component/form/inputField.html", 
                                                {   id:'load_tel', 
                                                    label:'联系电话', 
                                                    value:order.load_tel!''
                                                }){}%>
                        </div>
                    </div>
                    <div class="row"><!--  第4行  -->
                        <div class="col-lg-8">
                            <%include("/eeda/component/form/inputField.html", 
                                                {   id:'load_addr', 
                                                    label:'装货地址', 
                                                    value:order.load_addr!''
                                                }){}%>
                        </div>
                        <div class="col-lg-4">
                            <%include("/eeda/component/form/dateInputField.html", 
                                                {   id:'load_booking_time', 
                                                    label:'预约装柜时间', 
                                                    value:order.load_booking_time!''
                                                }){}%>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-12">
                            <h3>卸货信息</h3>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-4">
                            <%include("/eeda/component/form/inputSpField.html", 
                                {
                                    id: 'unload_sp_id', 
                                    label:' 卸货供应商', 
                                    required: 'required',
                                    value:order.unload_sp_id!'',
                                    display_value: sp_name!''
                                }){} %>
                        </div>
                        <div class="col-lg-4">
                            <%include("/eeda/component/form/inputField.html", 
                                                {   id:'unload_person', 
                                                    label:'联系人', 
                                                    value:order.unload_person!''
                                                }){}%>
                        </div>
                        <div class="col-lg-4">
                           <%include("/eeda/component/form/inputField.html", 
                                                {   id:'unload_tel', 
                                                    label:'联系电话', 
                                                    value:order.unload_tel!''
                                                }){}%>
                        </div>
                    </div>
                    <div class="row"><!--  第4行  -->
                        <div class="col-lg-8">
                            <%include("/eeda/component/form/inputField.html", 
                                                {   id:'unload_addr', 
                                                    label:'卸货地址', 
                                                    value:order.unload_addr!''
                                                }){}%>
                        </div>
                        <div class="col-lg-4">
                            <%include("/eeda/component/form/dateInputField.html", 
                                                {   id:'unload_booking_time', 
                                                    label:'预约卸货时间', 
                                                    value:order.unload_booking_time!''
                                                }){}%>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-12">
                            <h3>还柜信息</h3>
                        </div>
                    </div>
                    <div class="row"><!--  第4行  -->
                        <div class="col-lg-4">
                            <%include("/eeda/component/form/inputField.html", 
                                                {   id:'return_country', 
                                                    label:'国家', 
                                                    value:order.return_country!''
                                                }){}%>
                        </div>
                        
                        <div class="col-lg-4">
                            <%include("/eeda/component/form/inputField.html", 
                                                {   id:'return_person', 
                                                    label:'联系人', 
                                                    value:order.return_person!''
                                                }){}%>
                        </div>
                        <div class="col-lg-4">
                           <%include("/eeda/component/form/inputField.html", 
                                                {   id:'return_tel', 
                                                    label:'联系电话', 
                                                    value:order.return_tel!''
                                                }){}%>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-4">
                            <%include("/eeda/component/form/dateInputField.html", 
                                                {   id:'return_booking_time', 
                                                    label:'预约还柜时间', 
                                                    value:order.return_booking_time!''
                                                }){}%>
                        </div> 
                        <div class="col-lg-8">
                            <%include("/eeda/component/form/inputField.html", 
                                                {   id:'return_addr', 
                                                    label:'提柜地址', 
                                                    value:order.return_addr!''
                                                }){}%>
                        </div>
                    </div>
                </form>
            </div>
            
            <div class="row">
            	<div class="form-group">
                 <label>备注</label>
                 <textarea id="remark" class="form-control" rows="3" name="note">${order.remark!''}</textarea>
            	</div>
            </div>

			<div class="row" style="margin-top:15px">
				<ul id="orderTabs" class="nav nav-tabs">
					<li class="active">
						<a href="#cargoDetail" data-toggle="tab">货品明细</a>
					</li>
                    <li>
                        <a href="#chargeDetail" data-toggle="tab">费用明细</a>
                    </li>
				</ul>
				
				<div class="tab-content">
		            <div class="tab-pane fade active in" id="cargoDetail">
			            <div class="form-group">
			                <div class="col-lg-12">
			                    <button class="btn btn-success btn-xs" id="add_cargo">添加货品</button>
                                <br>
			                    <%include("/eeda/component/form/detailTable.html", 
			                        {
			                            id:'cargo_table',
			                            headers:['', '箱型', '箱量', '货物名称', '件数', 
                                                  '体积(CBM)','净重(KG)', '毛重(KG)', '备注'],
			                            field_list:['', 'container_type', 'container_amount', 'cargo_name',  'pieces',
			                            'volume', 'net_weight','gross_weight','remark'],
			                            value_list: cargoList![]
			                        }){} %>
			                </div>
			            </div>
		            </div>
		            
		            <div class="tab-pane fade in" id="chargeDetail">
			            <div class="form-group">
			                <div class="col-lg-12">
			                    <button class="btn btn-success btn-xs" id="add_charge">添加</button>
                                <br>
			                    <%include("/eeda/component/form/detailTable.html", 
                                    {
                                        id:'charge_table',
                                        style:'width: 1500px; margin-left: 0px;',
                                        headers:['', '类别', '结算公司', '费用名称', '单价', '数量', '单位', 
                                                 '币制', '金额', '收据汇率', '金额(人民币)','收据号码', '发票号码', '备注'],
                                        field_list:['', 'type', 'sp_id', 'charge_id', 'price', 'amount', 'unit_id', 'currency_id', 'total_amount',
                                         'exchange_rate', 'currency_total_amount', 'receipt_no', 'invoice_no', 'remark'],
                                        value_list: chargeList![]
                                    }){} %>
			                </div>
			            </div>
		            </div>
		            
		            
	            </div>
            </div>
            <br>
            <div class="row">
                <div class="col-lg-12">
                    <a id='saveBtn' class="btn  btn-primary" href="#">保存</a>
                    <button id="printBtn" type="button" class="btn  btn-primary" data-toggle="modal"  data-target=".bs-example-modal-sm">打印</button>
                    <a class="btn  btn-default" href="/truckOrder">返回</a>
                </div>
            </div>
        </div>
<%}%>

<script>
    var order_no = '${order.order_no!'订单编辑'}'; 
    var itemOrder = {};
</script>
<script>
    requirejs(['/js/common.js', '/js/eeda/eeda-common.js'], function (common) {
        requirejs(['app/oms/truckOrder/edit']);
        requirejs(['app/oms/truckOrder/edit_cargo_table']);
        requirejs(['app/oms/truckOrder/edit_charge_table']);
    });
</script>


