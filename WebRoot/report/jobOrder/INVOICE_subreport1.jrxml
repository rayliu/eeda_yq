<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="payment_subreport1" language="groovy" pageWidth="555" pageHeight="802" columnWidth="555" leftMargin="0" rightMargin="0" topMargin="0" bottomMargin="0" uuid="4f18f7a8-df82-4e27-8043-0a0ac9d24693">
	<property name="ireport.zoom" value="1.0"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<parameter name="order_id" class="java.lang.Long">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[select jor.*, pr.abbr sp_name, f.name charge_name,u.name unit_name,c.name currency_name,
(SELECT sum(total_amount) FROM job_order_arap jor
left join currency c on c.id=jor.currency_id
WHERE jor.order_type ='charge' and c.name='CNY' and jor.order_id=$P{order_id}) total_RMB,(SELECT sum(total_amount) FROM job_order_arap jor
left join currency c on c.id=jor.currency_id
WHERE jor.order_type ='charge' and c.name='USD'  and jor.order_id=$P{order_id}) total_USD
 from job_order_arap jor
 left join party pr on pr.id=jor.sp_id
 left join fin_item f on f.id=jor.charge_id
 left join unit u on u.id=jor.unit_id
 left join currency c on c.id=jor.currency_id
where jor.order_type ='charge' and jor.order_id=$P{order_id}]]>
	</queryString>
	<field name="id" class="java.lang.Long">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="order_id" class="java.lang.Long">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="order_type" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="type" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="sp_id" class="java.lang.String">
		<fieldDescription><![CDATA[供应商id]]></fieldDescription>
	</field>
	<field name="charge_id" class="java.lang.String">
		<fieldDescription><![CDATA[费用id]]></fieldDescription>
	</field>
	<field name="price" class="java.lang.Double">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="amount" class="java.lang.Double">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="unit_id" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="currency_id" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="total_amount" class="java.lang.Double">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="exchange_rate" class="java.lang.Double">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="currency_total_amount" class="java.lang.Double">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="receipt_type" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="receipt_no" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="invoice_no" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="create_time" class="java.sql.Timestamp">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="remark" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="audit_flag" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="bill_flag" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="sp_name" class="java.lang.String"/>
	<field name="charge_name" class="java.lang.String"/>
	<field name="unit_name" class="java.lang.String"/>
	<field name="currency_name" class="java.lang.String"/>
	<field name="total_RMB" class="java.lang.Double"/>
	<field name="total_USD" class="java.lang.Double"/>
	<variable name="sum" class="java.lang.Number" calculation="Sum">
		<variableExpression><![CDATA[$F{total_amount}]]></variableExpression>
	</variable>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band splitType="Stretch"/>
	</title>
	<pageHeader>
		<band splitType="Stretch"/>
	</pageHeader>
	<columnHeader>
		<band splitType="Stretch"/>
	</columnHeader>
	<detail>
		<band height="27" splitType="Stretch">
			<textField isBlankWhenNull="true">
				<reportElement x="2" y="1" width="130" height="20" uuid="f0369b48-d60a-4f47-b145-67e043adfec7"/>
                    <textElement>
                        <font pdfFontName="STSong-Light" pdfEncoding="UniGB-UCS2-H"/>
                    </textElement>
				<textFieldExpression><![CDATA[$F{charge_name}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="132" y="1" width="40" height="20" uuid="24180cc2-8979-4c32-917a-3d2583f6fbbb"/>
                    <textElement>
                        <font pdfFontName="STSong-Light" pdfEncoding="UniGB-UCS2-H"/>
                    </textElement>
				<textFieldExpression><![CDATA[($F{currency_name}.equals("CNY")?"RMB":$F{currency_name})]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="196" y="0" width="48" height="20" uuid="6041f6e7-0d81-4bba-abc5-dd79a3aeea7e"/>
                    <textElement>
                        <font pdfFontName="STSong-Light" pdfEncoding="UniGB-UCS2-H"/>
                    </textElement>
				<textFieldExpression><![CDATA[$F{price}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="296" y="0" width="40" height="20" uuid="73dd2c89-3aad-41eb-87e5-e0671bb0deed"/>
                    <textElement>
                        <font pdfFontName="STSong-Light" pdfEncoding="UniGB-UCS2-H"/>
                    </textElement>
				<textFieldExpression><![CDATA[$F{amount}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="409" y="1" width="40" height="20" uuid="231e70a2-7014-40a5-bb74-6d79f0e21fcb"/>
                    <textElement>
                        <font pdfFontName="STSong-Light" pdfEncoding="UniGB-UCS2-H"/>
                    </textElement>
				<textFieldExpression><![CDATA[$F{exchange_rate}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="497" y="1" width="58" height="20" uuid="1b8d5615-f2b4-4f1a-ae4a-5297dce29489"/>
                    <textElement>
                        <font pdfFontName="STSong-Light" pdfEncoding="UniGB-UCS2-H"/>
                    </textElement>
				<textFieldExpression><![CDATA[$F{currency_total_amount}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="460" y="1" width="19" height="20" uuid="fbc2d8d0-403a-4749-a507-12fea3b64b27"/>
				<textElement textAlignment="Center" verticalAlignment="Middle"/>
				<text><![CDATA[*]]></text>
			</staticText>
			<staticText>
				<reportElement x="254" y="1" width="15" height="20" uuid="cfbe667b-fe41-4bd5-af6e-0de5eb4d5e36"/>
				<textElement textAlignment="Center" verticalAlignment="Top"/>
				<text><![CDATA[X]]></text>
			</staticText>
			<textField isBlankWhenNull="true">
				<reportElement x="342" y="1" width="31" height="20" uuid="c81060fb-2e0c-471e-8de3-00617293b2ad"/>
				<textFieldExpression><![CDATA[$F{total_amount}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="381" y="0" width="24" height="20" uuid="59cd28a8-fd72-44af-a1da-5a2af5320dd1"/>
				<textFieldExpression><![CDATA[$F{unit_name}]]></textFieldExpression>
			</textField>
			<line>
				<reportElement x="0" y="26" width="553" height="1" uuid="df1ec94a-24cb-4f95-b7df-49d76e1540dd"/>
				<graphicElement>
					<pen lineStyle="Dashed"/>
				</graphicElement>
			</line>
		</band>
	</detail>
	<columnFooter>
		<band splitType="Stretch"/>
	</columnFooter>
	<pageFooter>
		<band splitType="Stretch"/>
	</pageFooter>
	<summary>
		<band height="40" splitType="Stretch">
			<staticText>
				<reportElement x="300" y="0" width="36" height="20" uuid="66206e75-7c4f-409c-8c8d-00270c919d97"/>
				<text><![CDATA[RMB:]]></text>
			</staticText>
			<staticText>
				<reportElement x="301" y="20" width="35" height="20" uuid="6673315e-2f68-480a-b001-02e39b71005a"/>
				<text><![CDATA[USD:]]></text>
			</staticText>
			<textField isBlankWhenNull="true">
				<reportElement x="342" y="0" width="31" height="20" uuid="ffd6bc81-be07-45d4-ab77-35bb8bb8506d"/>
				<textFieldExpression><![CDATA[$F{total_RMB}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="342" y="20" width="31" height="20" uuid="5279d663-ce01-4742-b043-8882ed0cb8fa"/>
				<textFieldExpression><![CDATA[$F{total_USD}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="2" y="0" width="69" height="40" uuid="aa5aa31e-daaa-40d8-9c37-771b22d11cd9"/>
				<textElement>
					<font fontName="宋体" size="14"/>
				</textElement>
				<text><![CDATA[大写金额：]]></text>
			</staticText>
		</band>
	</summary>
</jasperReport>
